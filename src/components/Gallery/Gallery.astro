---
import { getLangFromUrl, useTranslations } from "@/i18n/utils";
import { getImage } from "astro:assets";
import GalleryGrid from "./GalleryGrid";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

// Import gallery images
import gallery1Img from "../../../public/gallery/gallery1.png";
import gallery2Img from "../../../public/gallery/gallery2.png";
import gallery3Img from "../../../public/gallery/gallery3.png";
import gallery4Img from "../../../public/gallery/gallery4.png";
import gallery5Img from "../../../public/gallery/gallery5.png";
import gallery6Img from "../../../public/gallery/gallery6.png";
import gallery7Img from "../../../public/gallery/gallery7.png";
import gallery8Img from "../../../public/gallery/gallery8.png";

const imageSources = [gallery1Img, gallery2Img, gallery3Img, gallery4Img, gallery5Img, gallery6Img, gallery7Img, gallery8Img];

// Process images to webp and get URLs for React component
const getImageUrl = async (image: any) => {
  const processed = await getImage({
    src: image,
    format: "webp",
    quality: 95,
  });
  return processed.src;
};

// Process all images to get URLs for the carousel
const galleryImages = await Promise.all(
  imageSources.map(img => getImageUrl(img))
);
---

<section
  class=" w-full bg-[#0B1D26]"
  id="gallery"
>
  <div class="w-full mx-auto px-4 md:px-8 lg:px-[134px]">
    {/* Section Header */}
    <div class="text-center mb-8 md:mb-12">
      <div class="font-montserrat text-[#FBD784] uppercase text-[14px] md:text-[16px] lg:text-[18px] tracking-[4px] md:tracking-[6px] mb-4">
        {t("gallery.tagline")}
      </div>
      <h2 class="font-playfairDisplay text-[36px] md:text-[48px] lg:text-[58px] leading-[44px] md:leading-[56px] lg:leading-[68px] text-white text-center">
        {t("gallery.title")}
      </h2>
    </div>

    {/* Gallery Grid - Masonry Layout with Dialog */}
    <GalleryGrid client:load images={galleryImages} />
  </div>
</section>
